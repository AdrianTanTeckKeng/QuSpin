
cdef {c_basis_type} make_p_basis_template(bitop fliplr,ns_type next_state,unsigned long long MAX,{c_basis_type} s,
												int L,int pblock, NP_INT8_t * N,{c_basis_type} * basis):
	cdef {c_basis_type} Ns
	cdef NP_INT8_t rp

	cdef int j
	cdef unsigned long long i

	Ns = 0

	for i in range(MAX):
		rp = CheckState_P_template(fliplr,pblock,s,L)
		if rp > 0:
			basis[Ns] = s
			N[Ns] = rp
			Ns += 1

		s = next_state(s)

	return Ns