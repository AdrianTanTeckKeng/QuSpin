
cdef {c_basis_type} make_p_z_basis_template(bitop fliplr,bitop flip_all,ns_type next_state,
									unsigned long long MAX,unsigned long long s,int L, int pblock, int zblock,
									NP_INT8_t * N, {c_basis_type} * basis):
	cdef {c_basis_type} Ns
	cdef NP_INT8_t rpz
	cdef unsigned long long i

	Ns = 0
	for i in range(MAX):
		rpz = CheckState_P_Z_template(fliplr,flip_all,pblock,zblock,s,L)
		if rpz > 0:
			basis[Ns] = s
			N[Ns] = rpz
			Ns += 1
		s = next_state(s)

	return Ns