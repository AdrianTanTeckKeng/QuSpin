
cdef {c_basis_type} make_pz_basis_template(bitop fliplr,bitop flip_all,ns_type next_state,
										unsigned long long MAX,unsigned long long s,int L, int pzblock,
										NP_INT8_t * N, {c_basis_type} * basis):
	cdef {c_basis_type} Ns
	cdef NP_INT8_t rpz
	cdef unsigned long long i

	Ns = 0
	for i in range(MAX):
		rpz = CheckState_PZ_template(fliplr,flip_all,pzblock,s,L)
		if rpz > 0:
			basis[Ns] = s
			N[Ns] = rpz
			Ns += 1
		
		s = next_state(s)

	return Ns