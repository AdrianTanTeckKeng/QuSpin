subroutine make_m_basis(L,Nup,zbasis,Ns)
implicit none
Integer(kind=4), intent(in) :: L,Nup,Ns
Integer(kind=4), intent(out), dimension(Ns) :: zbasis
Integer(kind=4) :: i,s,t


s=0
do i=0,Nup-1
s = ibset(s,i)
end do


do i=1,Ns
zbasis(i)=s

t=ior(s,s-1)
s=ior(t+1,ishft(iand(not(t),-not(t))-1,-trailz(s)-1))

end do

end subroutine
